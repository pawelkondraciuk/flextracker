{% extends 'workflow/base.html' %}

{% load i18n %}
{% load staticfiles %}

{% block title %}{{ workflow.name }}{% endblock %}

{% block box-name %}
    <i class="fa fa-cog"></i>
    <span>Create new workflow</span>
{% endblock %}

{% block box-content %}
    {% verbatim %}
        <div ng-app="workflow" ng-controller="WorkflowController">
            {{ workflow.name }}
        </div>
    {% endverbatim %}
{% endblock %}

{% block javascript %}
    <script src="{% static 'js/workflow-angularjs.js' %}"></script>
    <script>
        angular.module('workflow.urls', [])
                .constant('projectId', {{ object.id }})
        $(function() {
            $("form").submit(function() {
                window.opener.addWorkflow({id: 1, value: 'Default'});
{#                var that = this;#}
{#                $.ajax({#}
{#                   type: "POST",#}
{#                   url: '.',#}
{#                   data: that.serialize(), // serializes the form's elements.#}
{#                   success: function(data) {#}
{#                       window.close();#}
{#                   }#}
{#                });#}

                return false; // avoid to execute the actual submit of the form.
            });
        });
    </script>
{% endblock %}